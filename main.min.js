"use strict";
function getCookie(e) {
    var o = document.cookie.match(new RegExp("(?:^|; )" + e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, "\\$1") + "=([^;]*)"));
    return o ? decodeURIComponent(o[1]) : void 0;
}
function setCookie(e, o, t) {
    var n,
        i = (t = t || {}).expires;
    "number" == typeof i && i && ((n = new Date()).setTime(n.getTime() + 1e3 * i), (i = t.expires = n)), i && i.toUTCString && (t.expires = i.toUTCString());
    var r = e + "=" + (o = encodeURIComponent(o));
    for (var c in t) {
        r += "; " + c;
        var a = t[c];
        !0 !== a && (r += "=" + a);
    }
    document.cookie = r;
}
("use strict");
document.addEventListener("DOMContentLoaded", init),
    window.addEventListener("load", loaded),
    window.addEventListener("orientationchange", function (e) {
        console.log("the orientation of the device is now " + e.target.screen.orientation.angle),
            console.log("orientation: portrait is " + window.matchMedia("(orientation: portrait)").matches),
            window.onresize(null),
            setTimeout(window.onresize, 350, null);
    });
var _btn = document.querySelector(".main-btn"),
    _slot = document.querySelector(".slot-bg"),
    _currStep = 1,
    _audio_music = document.querySelector("#snd-music"),
    _audio_reels = document.querySelector("#snd-reels"),
    _audio_reel_stop = document.querySelector("#snd-reel-stop"),
    _audio_popup_1 = document.querySelector("#snd-popup-1"),
    _audio_popup_2 = document.querySelector("#snd-popup-2"),
    _audio_win = document.querySelector("#snd-combo");
function loaded() {
    var e;
    getCookie("cosmo-cyber-japan") ? ((e = document.querySelector(".logo")), (setCookie("cosmo-cyber-japan", 1), initSlot())) : (setCookie("cosmo-cyber-japan", 1), initSlot()),
        (document.querySelector(".preload").style.display = "none"),
        (document.querySelector(".preloader").style.display = "none");
}
function initSlot() {
    (document.querySelector(".main-cont").style.opacity = "1"),
        setTimeout(typeText, 500, "Play now!", document.querySelector(".main-btn span"), 0),
        setTimeout(function () {
            for (var o = document.querySelectorAll(".slot-column"), e = 0; e < o.length; e++)
                setTimeout(
                    function (e) {
                        o[e].classList.remove("slot-column-pos");
                    },
                    100 * e,
                    e
                );
        }, 500),
        _btn.addEventListener("click", startSlotAnimation),
        _slot.addEventListener("click", startSlotAnimation);
    var e = document.querySelector("#snd-music").play();
    void 0 !== e &&
        e
            .then(function (e) {
                _audio_music.play(), (_audio_music.volume = 0.5), initSnd();
            })
            .catch(function (e) {
                console.log("oops");
            });
}
function init() {
    window.onresize(null);
}
var _contWidth = 1500,
    _contHeight = 920,
    _contWidthMob = 760,
    _contHeightMob = 1400,
    _bgWidth = 1860,
    _bgHeight = 1050,
    _popupWidth = 700,
    _popupHeight = 450,
    _scale = 1,
    _mob = !1;
function isMob() {
    var e = !1;
    return (
        (navigator.userAgent.match(/Android/i) ||
            navigator.userAgent.match(/webOS/i) ||
            navigator.userAgent.match(/iPhone/i) ||
            navigator.userAgent.match(/iPod/i) ||
            navigator.userAgent.match(/BlackBerry/i) ||
            navigator.userAgent.match(/Windows Phone/i)) &&
            (e = !0),
        e
    );
}
window.onresize = function () {
    var e,
        o,
        t = Math.min(document.documentElement.clientWidth, window.innerWidth || 0),
        l = Math.min(document.documentElement.clientHeight, window.innerHeight || 0),
        n = 0.01 * window.innerHeight;
    document.documentElement.style.setProperty("--vh", "".concat(n, "px")),
        t < l
            ? ((_mob = !0),
              document.querySelector(".main-cont").classList.add("mob"),
              document.querySelector(".slot-cont").classList.add("mob"),
              document.querySelector(".girl").classList.add("mob"),
              document.querySelector(".logo").classList.add("mob"),
              document.querySelector(".main-btn").classList.add("mob"),
              document.querySelector(".license").classList.add("mob"),
              document.querySelector(".wrapper").classList.add("mob"),
              document.querySelector(".smoke-pink").classList.add("mob"),
              document.querySelector(".smoke-blue").classList.add("mob"),
              (_scale = Math.min(t / _contWidthMob, (l - 48) / _contHeightMob, 1)),
              (document.querySelector(".main-cont").style.transform = "translateX(-50%) scale(" + _scale + ")"),
              (document.querySelector(".snd").style.transform = "scale(" + 1.5 * _scale + ")"))
            : ((_mob = !1),
              document.querySelector(".main-cont").classList.remove("mob"),
              document.querySelector(".slot-cont").classList.remove("mob"),
              document.querySelector(".girl").classList.remove("mob"),
              document.querySelector(".logo").classList.remove("mob"),
              document.querySelector(".main-btn").classList.remove("mob"),
              document.querySelector(".license").classList.remove("mob"),
              document.querySelector(".wrapper").classList.remove("mob"),
              document.querySelector(".smoke-pink").classList.remove("mob"),
              document.querySelector(".smoke-blue").classList.remove("mob"),
              (o = e = 1),
              (o =
                  l < 500
                      ? (document.querySelector(".license").classList.add("mob"), document.querySelector(".smoke-pink").classList.add("mob-hor"), document.querySelector(".smoke-blue").classList.add("mob-hor"), (e = 0.6), 2)
                      : (document.querySelector(".license").classList.remove("mob"), document.querySelector(".smoke-pink").classList.remove("mob-hor"), document.querySelector(".smoke-blue").classList.remove("mob-hor"), (e = 1), 1.5)),
              (_scale = Math.min(t / _contWidth, (l - 70 * e) / _contHeight, 1)),
              (document.querySelector(".main-cont").style.transform = "translate(-50%, calc(-50% - ".concat(35 * e, "px)) scale(").concat(_scale, ")")),
              (document.querySelector(".snd").style.transform = "scale(" + Math.min(_scale * o, 1) + ")")),
        (_scale = Math.min(t / _popupWidth, l / _popupHeight, 1)),
        (document.querySelector(".popup-window").style.transform = "translate(-50%, -50%) scale(" + _scale + ")"),
        (_scale = Math.max(t / _bgWidth, l / _bgHeight)),
        (document.querySelector(".bg").style.transform = "translateX(-50%) scale(" + _scale + ")");
};
var _combos = [
    [
        ["el-glpk", "el-lett", "el-letk"],
        ["el-letg", "el-glbl", "el-letg"],
        ["el-lett", "el-glpk", "el-lett"],
        ["el-letk", "el-letg", "el-glbl"],
    ],
    [
        ["el-lett", "el-glpk", "el-letg"],
        ["el-letg", "el-glpk", "el-glbl"],
        ["el-lett", "el-glpk", "el-lett"],
        ["el-glbl", "el-glpk", "el-letk"],
    ],
];
function startSlotAnimation() {
    _btn.removeEventListener("click", startSlotAnimation),
        _slot.removeEventListener("click", startSlotAnimation),
        _btn.classList.add("disabled"),
        console.log("click"),
        startColumnsAnimation(),
        (_audio_music.volume = 0.5),
        _audio_music.play(),
        initSnd();
}
function startColumnsAnimation() {
    for (var e = 1; e <= 4; e++) document.querySelector(".slot-column-" + e).classList.remove("slot-column-end"), document.querySelector(".slot-column-" + e).classList.add("slot-column-moving");
    (_audio_reels.currentTime = 0),
        _audio_reels.play(),
        setTimeout(function () {
            changeCombos(), stopColumnAnimation();
        }, 1e3);
}
var snd_fl = !0;
function initSnd() {
    var e = document.querySelector(".snd"),
        o = document.querySelector(".snd-icon");
    (e.style.display = "block"),
        (_audio_popup_2.volume = 0.75),
        snd_fl &&
            e.addEventListener("click", function () {
                console.log("snd"),
                    o.classList.contains("snd-on")
                        ? (o.classList.remove("snd-on"),
                          o.classList.add("snd-off"),
                          (_audio_music.volume = 0),
                          (_audio_reels.volume = 0),
                          (_audio_reel_stop.volume = 0),
                          (_audio_win.volume = 0),
                          (_audio_popup_1.volume = 0),
                          (_audio_popup_2.volume = 0))
                        : (o.classList.add("snd-on"),
                          o.classList.remove("snd-off"),
                          (_audio_music.volume = 0.5),
                          (_audio_reels.volume = 1),
                          (_audio_reel_stop.volume = 1),
                          (_audio_win.volume = 1),
                          (_audio_popup_1.volume = 1),
                          (_audio_popup_2.volume = 0.75));
            }),
        (snd_fl = !1);
}
function changeCombos() {
    for (var e = 0; e < 4; e++)
        for (var o = 0; o < 3; o++) {
            var t = _combos[_currStep - 1][e][o];
            document
                .querySelector(".slot-column-" + (e + 1))
                .querySelector(".slot-element-" + (o + 1))
                .setAttribute("class", "slot-element slot-element-" + (o + 1) + " " + t),
                document
                    .querySelector(".slot-column-" + (e + 1))
                    .querySelector(".slot-element-" + (o + 4))
                    .setAttribute("class", "slot-element slot-element-" + (o + 4) + " " + t);
        }
}
var _small_delay = 200,
    _middle_delay = 500,
    _big_delay = 750;
function stopColumnAnimation() {
    1 === _currStep &&
        (document.querySelector(".slot-column-1").classList.remove("slot-column-moving"),
        document.querySelector(".slot-column-1").classList.add("slot-column-end"),
        _audio_reel_stop.play(),
        setTimeout(function () {
            document.querySelector(".slot-column-2").classList.remove("slot-column-moving"),
                document.querySelector(".slot-column-2").classList.add("slot-column-end"),
                _audio_reel_stop.play(),
                setTimeout(function () {
                    (document.querySelector(".slot-column-3").style.opacity = "0.85"),
                        (document.querySelector(".slot-column-4").style.opacity = "0.85"),
                        _audio_reel_stop.play(),
                        setTimeout(function () {
                            document.querySelector(".slot-column-3").classList.remove("slot-column-moving"),
                                document.querySelector(".slot-column-3").classList.add("slot-column-end"),
                                (document.querySelector(".slot-column-3").style.opacity = "1"),
                                _audio_reel_stop.play(),
                                setTimeout(function () {
                                    document.querySelector(".slot-column-4").classList.remove("slot-column-moving"),
                                        document.querySelector(".slot-column-4").classList.add("slot-column-end"),
                                        (document.querySelector(".slot-column-4").style.opacity = "1"),
                                        _audio_reel_stop.play(),
                                        _audio_reels.pause(),
                                        setTimeout(showPopup, _middle_delay, 1);
                                }, _middle_delay);
                        }, _middle_delay);
                }, _middle_delay);
        }, _middle_delay)),
        2 === _currStep &&
            setTimeout(function () {
                document.querySelector(".slot-column-1").classList.remove("slot-column-moving"),
                    document.querySelector(".slot-column-1").classList.add("slot-column-end"),
                    _audio_reel_stop.play(),
                    setTimeout(function () {
                        (document.querySelector(".slot-column-2").style.opacity = "0.85"),
                            (document.querySelector(".slot-column-3").style.opacity = "0.85"),
                            (document.querySelector(".slot-column-4").style.opacity = "0.85"),
                            _audio_reel_stop.play(),
                            setTimeout(function () {
                                document.querySelector(".slot-column-2").classList.remove("slot-column-moving"),
                                    document.querySelector(".slot-column-2").classList.add("slot-column-end"),
                                    (document.querySelector(".slot-column-2").style.opacity = "1"),
                                    _audio_reel_stop.play(),
                                    setTimeout(function () {
                                        document.querySelector(".slot-column-3").classList.remove("slot-column-moving"),
                                            document.querySelector(".slot-column-3").classList.add("slot-column-end"),
                                            (document.querySelector(".slot-column-3").style.opacity = "1"),
                                            _audio_reel_stop.play(),
                                            setTimeout(function () {
                                                (document.querySelector(".slot-column-4").style.animationDuration = "0.1s"),
                                                    setTimeout(function () {
                                                        document.querySelector(".slot-column-4").classList.remove("slot-column-moving"),
                                                            document.querySelector(".slot-column-4").classList.add("slot-column-end"),
                                                            (document.querySelector(".slot-column-4").style.opacity = "1"),
                                                            setTimeout(showCombo, _middle_delay),
                                                            _audio_reel_stop.play(),
                                                            _audio_reels.pause();
                                                    }, _big_delay);
                                            }, _middle_delay);
                                    }, _middle_delay);
                            }, _middle_delay);
                    }, _middle_delay);
            }, _middle_delay);
}
function showCombo() {
    document.querySelector(".combo-line").classList.add("combo-show"),
        _audio_win.play(),
        setTimeout(function () {
            setTimeout(function () {
                showPopup(2), document.querySelector(".combo-line").classList.remove("combo-show");
            }, 2500);
        }, _big_delay);
}
function showPopup(e) {
    (document.querySelector(".popup").style.display = "block"),
        window.onresize(null),
        1 === e &&
            (document.querySelector(".popup").classList.add("show"),
                $('.bg').addClass('hidden'),
            document.querySelector("#turn-btn").addEventListener("click", hidePopup),
            document.querySelector(".popup-window").addEventListener("click", hidePopup),
            setTimeout(typeText, 500, "Spin again!", document.querySelector("#turn-btn span"), 0),
            _currStep++,
            _audio_popup_1.play()),
        2 === e &&
            ((document.querySelector(".popup-1").style.display = "none"),
            (document.querySelector(".popup-2").style.display = "block"),
            document.querySelector(".popup").classList.add("show"),
            $('.bg').addClass('hidden'),
            setTimeout(typeText, 500, "Claim your reward!", document.querySelector("#get-btn span"), 0),
            _audio_popup_2.play());
}
function hidePopup() {
    document.querySelector("#turn-btn").removeEventListener("click", hidePopup),
        document.querySelector(".popup-window").removeEventListener("click", hidePopup),
        document.querySelector("#turn-btn").classList.add("disabled"),
        document.querySelector(".popup").classList.remove("show"),
        $('.bg').removeClass('hidden'),
        document.querySelector(".popup").classList.add("hide"),
        document.querySelector(".popup").addEventListener("animationend", delPopup),
        startColumnsAnimation();
}
function delPopup() {
    console.log("del pop"), (document.querySelector(".popup").style.display = "none"), document.querySelector(".popup").classList.remove("hide"), document.querySelector(".popup").removeEventListener("animationend", delPopup);
}
function typeText(e, o, t) {
    t < e.length && ((o.innerHTML = e.slice(0, t + 1) + "<c>_</c>"), t++, setTimeout(typeText, 100, e, o, t));
}
